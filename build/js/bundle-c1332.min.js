!function(t){function e(e){for(var i,o,h=e[0],c=e[1],r=e[2],d=0,u=[];d<h.length;d++)o=h[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&u.push(n[o][0]),n[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);for(l&&l(e);u.length;)u.shift()();return a.push.apply(a,r||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],i=!0,h=1;h<s.length;h++){var c=s[h];0!==n[c]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=s[0]))}return t}var i={},n={0:0},a=[];function o(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=i,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(s,i,function(e){return t[e]}.bind(null,i));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var h=window.webpackJsonp=window.webpackJsonp||[],c=h.push.bind(h);h.push=e,h=h.slice();for(var r=0;r<h.length;r++)e(h[r]);var l=c;a.push([25,1]),s()}({23:function(t,e,s){},24:function(t,e,s){},25:function(t,e,s){"use strict";s.r(e);s(23),s(24);var i=s(0),n=s.n(i);const a=t=>{const e=document.querySelector(t);if(e instanceof HTMLElement)return e;throw new Error(`Ошибка, элемент с селектором: "${t}" не найден на странице`)};class o{constructor(){n()(this,"$modalWrapper",void 0),this.$modalWrapper=a(".modalWrapper")}init(){this.addListeners()}disabledBtn(t){t.setAttribute("disabled","true")}enabledBtn(t){t.removeAttribute("disabled")}closeModal(){this.$modalWrapper.classList.add("hiddenElement")}openModal(){this.$modalWrapper.classList.remove("hiddenElement")}}class h extends o{constructor(){super(),n()(this,"$body",void 0),n()(this,"$content",void 0),n()(this,"$changeThemeBtn",void 0),n()(this,"theme",void 0),this.$body=a("body"),this.$content=a(".content"),this.$changeThemeBtn=a(".changeTheme"),this.theme=this.$body.classList.value}addListeners(){this.$changeThemeBtn.addEventListener("click",(()=>{this.changeTheme()}))}changeTheme(){"theme_dark"===this.theme?([this.$body,this.$content].forEach((t=>t.classList.remove("theme_dark"))),[this.$body,this.$content].forEach((t=>t.classList.add("theme_light"))),this.theme="them_light"):([this.$body,this.$content].forEach((t=>t.classList.remove("theme_light"))),[this.$body,this.$content].forEach((t=>t.classList.add("theme_dark"))),this.theme="theme_dark")}}var c=s(28),r=s(33),l=s(29),d=s(11),u=s(30),v=s(31),p=s(32);class m extends o{constructor(t){super(),this.$canvas=t,n()(this,"$colorInput",void 0),n()(this,"$boldnessSelect",void 0),n()(this,"$clearBtn",void 0),n()(this,"$saveBtn",void 0),n()(this,"context",void 0),n()(this,"canvasRect",void 0),n()(this,"scale",void 0),n()(this,"drawing$",void 0),n()(this,"mouseDown$",void 0),n()(this,"mouseUp$",void 0),n()(this,"mouseOut$",void 0),n()(this,"strokeStyle$",void 0),n()(this,"lineWidth$",void 0),this.$colorInput=a("input[type=color]"),this.$boldnessSelect=a("select"),this.$clearBtn=a(".clear"),this.$saveBtn=a(".openModal"),this.context=t.getContext("2d"),this.canvasRect=t.getBoundingClientRect(),this.scale=window.devicePixelRatio,this.drawing$=Object(c.a)(t,"mousemove"),this.mouseDown$=Object(c.a)(t,"mousedown"),this.mouseUp$=Object(c.a)(t,"mouseup"),this.mouseOut$=Object(c.a)(t,"mouseout"),this.strokeStyle$=this.createOptionsStream(this.$colorInput,"input"),this.lineWidth$=this.createOptionsStream(this.$boldnessSelect,"change")}init(){super.init(),this.updateCanvasParams()}downloadImg(t,e){"jpeg"===e&&(this.context.globalCompositeOperation="destination-over",this.context.fillStyle="#ffffff",this.context.fillRect(0,0,this.$canvas.width,this.$canvas.height));const s=this.$canvas.toDataURL("image/"+e,1),i=a("body"),n=document.createElement("a");n.setAttribute("href",s),n.setAttribute("download",t),n.style.display="none",i.appendChild(n),n.click(),i.removeChild(n)}clearCanvas(){this.context.clearRect(0,0,this.$canvas.width,this.$canvas.height)}addListeners(){Object(c.a)(window,"resize").subscribe((()=>{this.updateCanvasParams()})),this.mouseDown$.pipe(Object(r.a)(this.strokeStyle$,this.lineWidth$,((t,e,s)=>({strokeStyle:e,lineWidth:s}))),Object(l.a)((t=>this.drawing$.pipe(Object(d.a)((e=>({x:e.offsetX,y:e.offsetY,options:t}))),Object(u.a)(),Object(v.a)(this.mouseUp$),Object(v.a)(this.mouseOut$))))).subscribe((([t,e])=>{const{strokeStyle:s,lineWidth:i}=e.options;[this.$clearBtn,this.$saveBtn].forEach((t=>this.enabledBtn(t))),this.context.beginPath(),this.context.strokeStyle=s,this.context.lineWidth=i,this.context.moveTo(t.x,t.y),this.context.lineTo(e.x,e.y),this.context.stroke()})),Object(c.a)(this.$clearBtn,"click").subscribe((()=>{this.clearCanvas(),[this.$clearBtn,this.$saveBtn].forEach((t=>this.disabledBtn(t)))})),Object(c.a)(this.$saveBtn,"click").subscribe((()=>{this.openModal()}))}createOptionsStream(t,e){return Object(c.a)(t,e).pipe(Object(d.a)((e=>{const s=e.target;return t instanceof HTMLSelectElement?+s.value:s.value})),Object(p.a)(t instanceof HTMLSelectElement?+t.value:t.value))}updateCanvasParams(){this.context=this.$canvas.getContext("2d"),this.canvasRect=this.$canvas.getBoundingClientRect(),this.scale=window.devicePixelRatio,this.$canvas.width=this.canvasRect.width*this.scale,this.$canvas.height=this.canvasRect.height*this.scale,this.context.scale(this.scale,this.scale)}}class $ extends o{constructor(t){super(),this.draw=t,n()(this,"$modalInput",void 0),n()(this,"$modalSelect",void 0),n()(this,"$saveBtn",void 0),n()(this,"$closeBtn",void 0),n()(this,"fileExtension","png"),n()(this,"fileName",""),this.$modalInput=a(".modal input"),this.$modalSelect=a(".modal select"),this.$saveBtn=a(".modal__btns .save"),this.$closeBtn=a(".modal__btns .closeModal")}init(){super.init(),this.disabledBtn(this.$saveBtn)}addListeners(){this.$saveBtn.addEventListener("click",(()=>{this.draw.downloadImg(this.fileName,this.fileExtension),this.closeModal(),this.draw.clearCanvas(),this.fileName="",this.$modalInput.value="",this.fileExtension="png",this.$modalSelect.value="png"})),this.$closeBtn.addEventListener("click",(()=>{this.closeModal()})),this.$modalInput.addEventListener("input",(t=>{const e=t.target;this.fileName=this.transformFileName(e.value.trim()),this.toggleDisabledSaveBtn()})),this.$modalSelect.addEventListener("change",(t=>{const e=t.target;this.fileExtension=e.value}))}transformFileName(t){return t.split(" ").join("_")}toggleDisabledSaveBtn(){this.fileName.trim()?this.enabledBtn(this.$saveBtn):this.disabledBtn(this.$saveBtn)}}window.addEventListener("DOMContentLoaded",(()=>{const t=new h,e=a("canvas"),s=new m(e),i=new $(s);t.init(),s.init(),i.init()}))}});